<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="MTG Card Voting Tool for Commander (EDH) - Vote on the power level of Magic: The Gathering cards and track results in real-time.">
  <title>MTG Card Voting Tool for Commander</title>
  <link rel="stylesheet" href="styles.css"> <!-- Link to your CSS file -->
  <link rel="icon" href="favicon.ico" type="image/x-icon"> <!-- Favicon -->
</head>
<body>
  <header>
    <h1>MTG Card Voting Tool for Commander</h1>
    <p>Welcome to the community-driven power bracket voting website for <strong>Commander (EDH)</strong>. This tool empowers the community to interpret and vote on the power levels of Magic: The Gathering cards in Commander, as defined by Wizards of the Coast.</p>
  </header>

  <noscript>
    <p style="color: red; text-align: center;">JavaScript is required for this tool to function properly. Please enable JavaScript in your browser.</p>
  </noscript>

  <main>
    <!-- Power Brackets Section -->
    <section>
      <h2>Power Brackets for Commander</h2>
      <div class="bracket-grid">
        <div class="bracket">
          <h3>Bracket 1: Casual Commander</h3>
          <p><strong>Relaxed and Fun:</strong> These decks prioritize creativity and social interaction over winning. Perfect for low-power, casual games with friends.</p>
        </div>
        <div class="bracket">
          <h3>Bracket 2: Average Commander</h3>
          <p><strong>Balanced and Refined:</strong> These decks include some synergies and stronger cards but are still designed for fun, mid-power games.</p>
        </div>
        <div class="bracket">
          <h3>Bracket 3: High-Power Commander</h3>
          <p><strong>Optimized and Powerful:</strong> These decks are highly tuned and can execute strong strategies consistently, but they still allow for interaction and counterplay.</p>
        </div>
        <div class="bracket">
          <h3>Bracket 4: High-Power Optimization</h3>
          <p><strong>Highly Tuned and Efficient:</strong> These decks are optimized for maximum power and consistency. While not competitive, they can push the boundaries of casual play and may lead to high-salt games.</p>
        </div>
      </div>
    </section>

    <!-- Card Voting Section -->
    <section>
      <h2>Vote on Commander Cards</h2>
      <div id="cardContainer" class="card-grid">
        <!-- Example card (you can add more cards manually or dynamically) -->
        <div class="card-details">
          <img src="path/to/card-image.jpg" alt="Card Image of Example Card" />
          <p><strong>Card Name:</strong> Example Card</p>
          <p><strong>Mana Cost:</strong> {2}{U}</p>
          <p><strong>Card Type:</strong> Creature â€” Human Wizard</p>
          <p><strong>Text:</strong> Example card text goes here.</p>
          <p><strong>Power/Toughness:</strong> 2/2</p>
          <p><strong>EDHREC Rank:</strong> N/A</p>
          <div class="vote-buttons">
            <button onclick="vote('Example Card', 1, event)">Power Level 1</button>
            <button onclick="vote('Example Card', 2, event)">Power Level 2</button>
            <button onclick="vote('Example Card', 3, event)">Power Level 3</button>
            <button onclick="vote('Example Card', 4, event)">Power Level 4</button>
            <button onclick="vote('Example Card', 0, event)">Not Ready to Vote</button>
          </div>
        </div>
      </div>
      <!-- Removed the "Next 3 Cards" button since we're not dynamically loading cards -->
    </section>
  </main>

  <footer>
    <div id="results" aria-live="polite">
      <!-- Voting results will be displayed here -->
    </div>
  </footer>

  <script>
    // Voting function (same as before)
    async function vote(cardName, powerLevel, event) {
      const cardElement = event.target.closest(".card-details");
      const buttons = cardElement.querySelectorAll(".vote-buttons button");

      try {
        // Disable buttons and show loading state
        buttons.forEach((button) => {
          button.disabled = true;
          button.style.backgroundColor = "#cccccc";
        });

        // Send vote to Google Apps Script
        const response = await fetch(
          "https://script.google.com/macros/s/AKfycby9GxLAK01t0eMQaA6MdCXRKmtFf2zX5gn-Ayx3mvavNft5C_5VzQfar4kT1eW58TOo/exec",
          {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify({ cardName, powerLevel }),
            mode: 'no-cors',
          }
        );

        // Show confirmation message
        const confirmation = document.createElement("p");
        confirmation.textContent = `Voted: Power Level ${powerLevel}`;
        confirmation.style.color = "green";
        cardElement.appendChild(confirmation);
      } catch (error) {
        console.error("Error saving vote:", error);

        // Re-enable buttons and show error message
        buttons.forEach((button) => {
          button.disabled = false;
          button.style.backgroundColor = "";
        });

        const errorMessage = document.createElement("p");
        errorMessage.textContent = `Failed to save vote: ${error.message}`;
        errorMessage.style.color = "red";
        cardElement.appendChild(errorMessage);
      }
    }
  </script>
</body>
</html>
